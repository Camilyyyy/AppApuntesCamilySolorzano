<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AppApuntesCamilySolorzano.Views.WeatherPage"
             Title="WeatherPage">
    <ScrollView>
        <StackLayout Padding="20" Spacing="20">

            <!-- Botones de control -->
            <StackLayout Orientation="Horizontal" Spacing="10">
                <Button Text="Actualizar Clima" 
                        Command="{Binding LoadWeatherCommand}"
                        BackgroundColor="#007ACC"
                        TextColor="White"
                        IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                        HorizontalOptions="FillAndExpand" />

                <Button Text="Ver Historial" 
                        Command="{Binding LoadHistoryCommand}"
                        BackgroundColor="#28a745"
                        TextColor="White"
                        IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                        HorizontalOptions="FillAndExpand" />
            </StackLayout>

            <!-- Indicador de carga -->
            <ActivityIndicator IsVisible="{Binding IsLoading}" 
                             IsRunning="{Binding IsLoading}"
                             Color="#007ACC" />

            <!-- Mensaje de error -->
            <Label Text="{Binding ErrorMessage}"
                   TextColor="Red"
                   IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}"
                   FontSize="14" />

            <!-- Datos del clima actual -->
            <Frame BackgroundColor="LightBlue" 
                   Padding="15" 
                   CornerRadius="10"
                   IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}">

                <StackLayout Spacing="15">
                    <Label Text="Clima Actual" 
                           FontSize="20" 
                           FontAttributes="Bold" 
                           HorizontalOptions="Center" />

                    <!-- Hora -->
                    <StackLayout Orientation="Horizontal">
                        <Label Text="ðŸ•’ Hora:" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               VerticalOptions="Center" />
                        <Label Text="{Binding Hora}" 
                               FontSize="18" 
                               VerticalOptions="Center" />
                    </StackLayout>

                    <!-- Temperatura -->
                    <StackLayout Orientation="Horizontal">
                        <Label Text="ðŸŒ¡ï¸ Temperatura:" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               VerticalOptions="Center" />
                        <Label FontSize="18" VerticalOptions="Center">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{0} {1}">
                                    <Binding Path="Temperatura" />
                                    <Binding Path="UnidadTemperatura" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </StackLayout>

                    <!-- Humedad -->
                    <StackLayout Orientation="Horizontal">
                        <Label Text="ðŸ’§ Humedad:" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               VerticalOptions="Center" />
                        <Label FontSize="18" VerticalOptions="Center">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{0} {1}">
                                    <Binding Path="Humedad" />
                                    <Binding Path="UnidadHumedad" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </StackLayout>

                    <!-- Lluvia -->
                    <StackLayout Orientation="Horizontal">
                        <Label Text="ðŸŒ§ï¸ Lluvia:" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               VerticalOptions="Center" />
                        <Label FontSize="18" VerticalOptions="Center">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{0} {1}">
                                    <Binding Path="Lluvia" />
                                    <Binding Path="UnidadLluvia" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </StackLayout>
                </StackLayout>
            </Frame>
        </StackLayout>
    </ScrollView>
</ContentPage>